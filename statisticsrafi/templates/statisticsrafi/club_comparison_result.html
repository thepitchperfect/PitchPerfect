{% extends 'statisticsrafi/base.html' %}

{% block title %}{{ club1.name }} vs {{ club2.name }} - Club Comparison{% endblock %}

{% block content %}
<style>
.comparison-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.club-header {
    display: flex;
    align-items: center;
    padding: 20px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    margin-bottom: 20px;
}

.club-logo {
    width: 60px;
    height: 60px;
    object-fit: contain;
    margin-right: 20px;
}

.club-info h2 {
    margin: 0 0 5px 0;
    font-size: 1.5rem;
    font-weight: bold;
    color: #1f2937;
}

.club-region {
    color: #6b7280;
    font-size: 0.9rem;
    margin-bottom: 10px;
}

.stats-grid {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: 20px;
    align-items: center;
    margin-bottom: 15px;
}

.stat-value {
    background: #10b981;
    color: white;
    padding: 8px 16px;
    border-radius: 6px;
    font-weight: bold;
    font-size: 1.1rem;
    text-align: center;
}

.form-indicator {
    font-size: 0.9rem;
    color: #6b7280;
}

.tabs {
    display: flex;
    gap: 10px;
    margin-top: 15px;
}

.tab {
    padding: 8px 16px;
    border-radius: 6px;
    background: #f3f4f6;
    color: #6b7280;
    cursor: pointer;
    font-size: 0.9rem;
}

.tab.active {
    background: #FE8800;
    color: white;
}

.comparison-table {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    overflow: hidden;
}

.section-header {
    background: #10b981;
    color: white;
    padding: 15px 20px;
    font-weight: bold;
    font-size: 1.1rem;
}

.category-title {
    background: #f8fafc;
    padding: 10px 20px;
    font-weight: 600;
    color: #374151;
    border-bottom: 1px solid #e5e7eb;
}

.stat-row {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    padding: 15px 20px;
    border-bottom: 1px solid #f3f4f6;
    align-items: center;
}

.stat-row:nth-child(even) {
    background: #f8fafc;
}

.stat-name {
    font-weight: 500;
    color: #374151;
}

.stat-club1, .stat-club2 {
    text-align: center;
    font-weight: 600;
}

.stat-club1.highlight {
    background: #dbeafe;
    padding: 5px 10px;
    border-radius: 4px;
}

.stat-club2.highlight {
    background: #dbeafe;
    padding: 5px 10px;
    border-radius: 4px;
}

.locked-stat {
    color: #9ca3af;
    font-style: italic;
}

.lock-icon {
    color: #6b7280;
    margin-right: 5px;
}

.back-button {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    padding: 1rem 2rem;
    background: var(--color-orange-300);
    color: white;
    text-decoration: none;
    border-radius: 50px;
    font-family: var(--font-subheader);
    font-weight: 600;
    box-shadow: 0 4px 12px rgba(254, 152, 0, 0.4);
    transition: transform 0.2s ease-in-out;
    z-index: 100;
}

.back-button:hover {
    transform: translateY(-2px);
}
</style>

<div class="comparison-container">
    <!-- Club Headers -->
    <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; margin-bottom: 30px; align-items: center;">
        <!-- Club 1 Header -->
        <div class="club-header left">
            {% if club1.logo_url %}
            <img src="{{ club1.logo_url }}" alt="{{ club1.name }} logo" class="club-logo">
            {% endif %}
            <div class="club-info">
                <div class="club-region">{{ club1.league.region }}</div>
                <h2>{{ club1.name }}</h2>
                {% if stats1 %}
            {% endif %}
        </div>
    </div>
    
        <!-- VS Element -->
        <div style="text-align: center;">
            <div style="background: linear-gradient(135deg, #FE8800, #FE8800); color: white; padding: 15px 20px; border-radius: 50%; font-weight: bold; font-size: 1.2rem; box-shadow: 0 4px 12px rgba(254, 136, 0, 0.3);">
                VS
            </div>
        </div>

        <!-- Club 2 Header -->
        <div class="club-header right">
            {% if club2.logo_url %}
            <img src="{{ club2.logo_url }}" alt="{{ club2.name }} logo" class="club-logo">
            {% endif %}
            <div class="club-info">
                <div class="club-region">{{ club2.league.region }}</div>
                <h2>{{ club2.name }}</h2>
                {% if stats2 %}
            {% endif %}
        </div>
    </div>
</div>

    <!-- Statistics Comparison Table -->
    <div class="comparison-table">
        <div class="section-header">Overall Stats</div>
    
    {% if stats1 or stats2 %}
        <!-- Season Overview -->
        <div class="category-title">Season Overview</div>
        
        <div class="stat-row">
            <div class="stat-name">Games Played</div>
            <div class="stat-club1 {% if stats1.matches_played > stats2.matches_played %}highlight{% endif %}">{{ stats1.matches_played|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.matches_played > stats1.matches_played %}highlight{% endif %}">{{ stats2.matches_played|default:"0" }}</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Wins</div>
            <div class="stat-club1 {% if stats1.wins > stats2.wins %}highlight{% endif %}">{{ stats1.wins|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.wins > stats1.wins %}highlight{% endif %}">{{ stats2.wins|default:"0" }}</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Draws</div>
            <div class="stat-club1 {% if stats1.draws > stats2.draws %}highlight{% endif %}">{{ stats1.draws|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.draws > stats1.draws %}highlight{% endif %}">{{ stats2.draws|default:"0" }}</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Losses</div>
            <div class="stat-club1 {% if stats1.losses < stats2.losses %}highlight{% endif %}">{{ stats1.losses|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.losses < stats1.losses %}highlight{% endif %}">{{ stats2.losses|default:"0" }}</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Points Per Game</div>
            <div class="stat-club1 {% if stats1.win_percentage > stats2.win_percentage %}highlight{% endif %}">{{ stats1.win_percentage|floatformat:2|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.win_percentage > stats1.win_percentage %}highlight{% endif %}">{{ stats2.win_percentage|floatformat:2|default:"0" }}</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">AVG Goals</div>
            <div class="stat-club1 {% if stats1.avg_match_goals > stats2.avg_match_goals %}highlight{% endif %}">{{ stats1.avg_match_goals|floatformat:2|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.avg_match_goals > stats1.avg_match_goals %}highlight{% endif %}">{{ stats2.avg_match_goals|floatformat:2|default:"0" }}</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">AVG Goals Scored</div>
            <div class="stat-club1 {% if stats1.scored_per_match > stats2.scored_per_match %}highlight{% endif %}">{{ stats1.scored_per_match|floatformat:2|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.scored_per_match > stats1.scored_per_match %}highlight{% endif %}">{{ stats2.scored_per_match|floatformat:2|default:"0" }}</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">AVG Goals Conceded</div>
            <div class="stat-club1 {% if stats1.conceded_per_match < stats2.conceded_per_match %}highlight{% endif %}">{{ stats1.conceded_per_match|floatformat:2|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.conceded_per_match < stats1.conceded_per_match %}highlight{% endif %}">{{ stats2.conceded_per_match|floatformat:2|default:"0" }}</div>
        </div>

        <!-- Attack / Defence -->
        <div class="category-title">Attack / Defence</div>
        
        <div class="stat-row">
            <div class="stat-name">Goals Scored</div>
            <div class="stat-club1 {% if stats1.scored_per_match > stats2.scored_per_match %}highlight{% endif %}">{{ stats1.scored_per_match|floatformat:0|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.scored_per_match > stats1.scored_per_match %}highlight{% endif %}">{{ stats2.scored_per_match|floatformat:0|default:"0" }}</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Goals Conceded</div>
            <div class="stat-club1 {% if stats1.conceded_per_match < stats2.conceded_per_match %}highlight{% endif %}">{{ stats1.conceded_per_match|floatformat:0|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.conceded_per_match < stats1.conceded_per_match %}highlight{% endif %}">{{ stats2.conceded_per_match|floatformat:0|default:"0" }}</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Clean Sheet Games</div>
            <div class="stat-club1 {% if stats1.clean_sheets_percentage > stats2.clean_sheets_percentage %}highlight{% endif %}">{{ stats1.clean_sheets_percentage|floatformat:0|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.clean_sheets_percentage > stats1.clean_sheets_percentage %}highlight{% endif %}">{{ stats2.clean_sheets_percentage|floatformat:0|default:"0" }}</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Clean Sheet %</div>
            <div class="stat-club1 {% if stats1.clean_sheets_percentage > stats2.clean_sheets_percentage %}highlight{% endif %}">{{ stats1.clean_sheets_percentage|floatformat:1|default:"0" }}%</div>
            <div class="stat-club2 {% if stats2.clean_sheets_percentage > stats1.clean_sheets_percentage %}highlight{% endif %}">{{ stats2.clean_sheets_percentage|floatformat:1|default:"0" }}%</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Failed To Score</div>
            <div class="stat-club1 {% if stats1.failed_to_score_percentage < stats2.failed_to_score_percentage %}highlight{% endif %}">{{ stats1.failed_to_score_percentage|floatformat:0|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.failed_to_score_percentage < stats1.failed_to_score_percentage %}highlight{% endif %}">{{ stats2.failed_to_score_percentage|floatformat:0|default:"0" }}</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Failed To Score %</div>
            <div class="stat-club1 {% if stats1.failed_to_score_percentage < stats2.failed_to_score_percentage %}highlight{% endif %}">{{ stats1.failed_to_score_percentage|floatformat:1|default:"0" }}%</div>
            <div class="stat-club2 {% if stats2.failed_to_score_percentage < stats1.failed_to_score_percentage %}highlight{% endif %}">{{ stats2.failed_to_score_percentage|floatformat:1|default:"0" }}%</div>
        </div>

        <!-- Outcome Percentage -->
        <div class="category-title">Outcome Percentage</div>
        
        <div class="stat-row">
            <div class="stat-name">Win %</div>
            <div class="stat-club1 {% if stats1.win_percentage > stats2.win_percentage %}highlight{% endif %}">{{ stats1.win_percentage|floatformat:0|default:"0" }}%</div>
            <div class="stat-club2 {% if stats2.win_percentage > stats1.win_percentage %}highlight{% endif %}">{{ stats2.win_percentage|floatformat:0|default:"0" }}%</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Draw %</div>
            <div class="stat-club1 {% if stats1.draws > stats2.draws %}highlight{% endif %}">
                {% if stats1.matches_played > 0 %}
                    {% widthratio stats1.draws stats1.matches_played 100 %}%
                    {% else %}
                    0%
                    {% endif %}
            </div>
            <div class="stat-club2 {% if stats2.draws > stats1.draws %}highlight{% endif %}">
                {% if stats2.matches_played > 0 %}
                    {% widthratio stats2.draws stats2.matches_played 100 %}%
                    {% else %}
                    0%
                    {% endif %}
            </div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Loss %</div>
            <div class="stat-club1 {% if stats1.losses < stats2.losses %}highlight{% endif %}">
                {% if stats1.matches_played > 0 %}
                    {% widthratio stats1.losses stats1.matches_played 100 %}%
                    {% else %}
                    0%
                    {% endif %}
            </div>
            <div class="stat-club2 {% if stats2.losses < stats1.losses %}highlight{% endif %}">
                {% if stats2.matches_played > 0 %}
                    {% widthratio stats2.losses stats2.matches_played 100 %}%
                    {% else %}
                    0%
                    {% endif %}
            </div>
        </div>

        <!-- Possession & Shots -->
        <div class="category-title">Possession & Shots</div>
        
        <div class="stat-row">
            <div class="stat-name">Possession %</div>
            <div class="stat-club1 {% if stats1.possession_avg > stats2.possession_avg %}highlight{% endif %}">{{ stats1.possession_avg|floatformat:1|default:"0" }}%</div>
            <div class="stat-club2 {% if stats2.possession_avg > stats1.possession_avg %}highlight{% endif %}">{{ stats2.possession_avg|floatformat:1|default:"0" }}%</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Shots per Match</div>
            <div class="stat-club1 {% if stats1.shots_taken_per_match > stats2.shots_taken_per_match %}highlight{% endif %}">{{ stats1.shots_taken_per_match|floatformat:1|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.shots_taken_per_match > stats1.shots_taken_per_match %}highlight{% endif %}">{{ stats2.shots_taken_per_match|floatformat:1|default:"0" }}</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Conversion Rate %</div>
            <div class="stat-club1 {% if stats1.shots_conversion_rate > stats2.shots_conversion_rate %}highlight{% endif %}">{{ stats1.shots_conversion_rate|floatformat:1|default:"0" }}%</div>
            <div class="stat-club2 {% if stats2.shots_conversion_rate > stats1.shots_conversion_rate %}highlight{% endif %}">{{ stats2.shots_conversion_rate|floatformat:1|default:"0" }}%</div>
        </div>

        <!-- Fouls -->
        <div class="category-title">Fouls</div>
        
        <div class="stat-row">
            <div class="stat-name">Fouls Committed per Match</div>
            <div class="stat-club1 {% if stats1.fouls_committed_per_match < stats2.fouls_committed_per_match %}highlight{% endif %}">{{ stats1.fouls_committed_per_match|floatformat:1|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.fouls_committed_per_match < stats1.fouls_committed_per_match %}highlight{% endif %}">{{ stats2.fouls_committed_per_match|floatformat:1|default:"0" }}</div>
        </div>
        
        <div class="stat-row">
            <div class="stat-name">Fouled Against per Match</div>
            <div class="stat-club1 {% if stats1.fouled_against_per_match > stats2.fouled_against_per_match %}highlight{% endif %}">{{ stats1.fouled_against_per_match|floatformat:1|default:"0" }}</div>
            <div class="stat-club2 {% if stats2.fouled_against_per_match > stats1.fouled_against_per_match %}highlight{% endif %}">{{ stats2.fouled_against_per_match|floatformat:1|default:"0" }}</div>
        </div>
        
                    {% else %}
        <div style="text-align: center; color: #6b7280; padding: 3rem;">
        No statistics available for this season. Add club statistics in the admin panel!
        </div>
    {% endif %}
</div>

    <div style="text-align: center; margin-top: 30px;">
        <a href="{% url 'statisticsrafi:compare_clubs' %}" class="btn btn-primary" style="margin-right: 10px;">Compare Other Clubs</a>
    </div>
</div>

<!-- Floating Back Button -->
<a href="{% url 'statisticsrafi:home' %}" class="back-button">
    ‚Üê Back to Home
</a>
{% endblock %}
