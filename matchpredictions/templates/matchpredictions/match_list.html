{% load static %}

{% if matches %}
  <div class="flex flex-col gap-8 animate-fade-in">
    {% for match in matches %}
    <div class="match-card bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 p-6 border border-gray-200 flex flex-col sm:flex-row justify-between items-center w-full relative overflow-hidden">

      <!-- âœ¨ Gradient Shine Line -->
      <div class="absolute inset-0 bg-gradient-to-r from-transparent via-orange-200/30 to-transparent opacity-0 hover:opacity-100 animate-shine pointer-events-none"></div>

      <!-- ðŸ† League + Match Info -->
      <div class="flex flex-col items-center sm:items-start sm:w-1/3 mb-4 sm:mb-0">
        <div class="flex items-center gap-3 mb-2">
          {% if match.league.name == "Premier League" %}
            <img src="{% static 'images/leagues/premier_league.png' %}" alt="Premier League"
                 class="w-8 h-8 rounded-full border border-gray-300 bg-white p-0.5 logo-animate">
          {% elif match.league.name == "La Liga" %}
            <img src="{% static 'images/leagues/la_liga.png' %}" alt="La Liga"
                 class="w-8 h-8 rounded-full border border-gray-300 bg-white p-0.5 logo-animate">
          {% elif match.league.name == "Serie A" %}
            <img src="{% static 'images/leagues/serie_a.png' %}" alt="Serie A"
                 class="w-8 h-8 rounded-full border border-gray-300 bg-white p-0.5 logo-animate">
          {% elif match.league.name == "Bundesliga" %}
            <img src="{% static 'images/leagues/bundesliga.png' %}" alt="Bundesliga"
                 class="w-8 h-8 rounded-full border border-gray-300 bg-white p-0.5 logo-animate">
          {% elif match.league.name == "Ligue 1" %}
            <img src="{% static 'images/leagues/ligue_1.png' %}" alt="Ligue 1"
                 class="w-8 h-8 rounded-full border border-gray-300 bg-white p-0.5 logo-animate">
          {% else %}
            <img src="{% static 'images/leagues/default.png' %}" alt="{{ match.league.name }}"
                 class="w-8 h-8 rounded-full border border-gray-300 bg-white p-0.5 logo-animate">
          {% endif %}

          <a href="?league={{ match.league.id }}"
             class="text-indigo-600 hover:text-indigo-800 font-semibold text-sm transition">
             {{ match.league.name }}
          </a>
        </div>

        <span class="text-sm text-gray-500">{{ match.match_date|date:"D, M d, Y H:i" }}</span>
        <span class="mt-1 inline-block px-3 py-1 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-lg uppercase tracking-wide">
          {{ match.status }}
        </span>
      </div>

      <!-- âš½ Teams -->
      <div class="flex flex-col items-center justify-center gap-3 sm:w-1/2 text-center">
        <div class="flex flex-col sm:flex-row items-center justify-center gap-6">
          <div class="flex flex-col items-center">
            <img src="{{ match.home_team.logo_url }}" alt="{{ match.home_team.name }}"
                 class="team-logo w-20 h-20 mb-2 rounded-full border border-gray-200 p-1 bg-white transition-transform duration-300 hover:scale-110">
            <p class="font-semibold text-base truncate w-28">{{ match.home_team.name }}</p>
          </div>

          <p class="font-bold text-xl text-gray-600">vs</p>

          <div class="flex flex-col items-center">
            <img src="{{ match.away_team.logo_url }}" alt="{{ match.away_team.name }}"
                 class="team-logo w-20 h-20 mb-2 rounded-full border border-gray-200 p-1 bg-white transition-transform duration-300 hover:scale-110">
            <p class="font-semibold text-base truncate w-28">{{ match.away_team.name }}</p>
          </div>
        </div>

        <!-- ðŸ“Š Win Probability -->
        <div class="mt-3">
          <p class="text-xs uppercase tracking-wide text-gray-500 font-semibold mb-1">Win Probability</p>
          {% if match.votes.count > 0 %}
            <p class="text-sm text-gray-800 font-medium">
              H {{ match.vote_summary.home_win }}% &nbsp;|&nbsp;
              D {{ match.vote_summary.draw }}% &nbsp;|&nbsp;
              A {{ match.vote_summary.away_win }}%
            </p>
          {% else %}
            <p class="text-xs text-gray-400 italic">No votes yet</p>
          {% endif %}
        </div>
      </div>

      <!-- ðŸ”˜ Buttons -->
      <div class="flex justify-center sm:justify-end gap-3 mt-4 sm:mt-0 sm:w-1/3">
        {% if user.is_authenticated %}
          <a href="{% url 'matchpredictions:match_detail' match.id %}"
             class="vote-now-btn bg-gray-700 hover:bg-gray-800 text-white px-4 py-2 rounded-lg text-sm font-medium transition-all duration-300 shadow-md hover:shadow-lg hover:scale-105 relative overflow-hidden">
             <span class="relative z-10">Vote Now</span>
             <span class="absolute inset-0 bg-gradient-to-r from-yellow-500 to-orange-400 opacity-0 hover:opacity-100 transition-opacity duration-300"></span>
          </a>
        {% else %}
          <a href="{% url 'login' %}?next={{ request.path }}"
             class="bg-gray-400 hover:bg-gray-500 text-white px-4 py-2 rounded-lg text-sm font-medium transition">
             ðŸ”’ Login to Vote
          </a>
        {% endif %}

        {% if user.is_staff %}
          <a href="{% url 'matchpredictions:match_update' match.id %}"
             class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition">
            Edit
          </a>
          <a href="{% url 'matchpredictions:match_delete' match.id %}"
             class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition">
            Delete
          </a>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>

{% else %}
  {% if filter_type == 'my' %}
    <div class="mt-20 mx-auto max-w-md bg-orange-50 border-l-4 border-orange-400 text-orange-700 px-5 py-4 rounded-lg shadow-sm text-center animate-fade-in">
      <p class="font-semibold">You havenâ€™t made any predictions yet.</p>
      <p class="text-sm text-gray-600 mt-1">Start voting on matches to see them here!</p>
    </div>
  {% else %}
    <p class="text-center text-gray-500 text-lg mt-20">No matches available</p>
  {% endif %}
{% endif %}

<style>
/* âœ¨ Fade & Slide animation when list loads */
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(15px); }
  to { opacity: 1; transform: translateY(0); }
}
.animate-fade-in {
  animation: fadeInUp 0.5s ease-in-out;
}

/* ðŸ’« Hover glow line animation */
@keyframes shine {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}
.animate-shine::before {
  content: "";
  position: absolute;
  inset: 0;
  transform: translateX(-100%);
  background: linear-gradient(120deg, transparent, rgba(255,255,255,0.4), transparent);
  animation: shine 1.8s infinite;
}

/* ðŸŒ€ Logo bounce effect */
.logo-animate {
  transition: transform 0.3s ease;
}
.logo-animate:hover {
  transform: rotate(-5deg) scale(1.1);
}

/* ðŸŒŸ Match card hover lift */
.match-card:hover {
  transform: translateY(-4px);
  border-color: #fbbf24;
}

/* ðŸ”¥ Vote button glow */
.vote-now-btn:hover {
  box-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
}
</style>
