{% load static %}

{% if matches %}
  <div class="flex flex-col gap-8">
    {% for match in matches %}
    <div class="bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 p-6 border border-gray-200 flex flex-col sm:flex-row justify-between items-center w-full">

      <!-- üèÜ League + Match Info -->
      <div class="flex flex-col items-center sm:items-start sm:w-1/3 mb-4 sm:mb-0">
        <!-- League Section -->
        <div class="flex items-center gap-3 mb-2">
          {% if match.league.name == "Premier League" %}
            <img src="{% static 'images/leagues/premier_league.png' %}" alt="Premier League" 
                 class="w-8 h-8 rounded-full border border-gray-300 bg-white p-0.5">
          {% elif match.league.name == "La Liga" %}
            <img src="{% static 'images/leagues/la_liga.png' %}" alt="La Liga" 
                 class="w-8 h-8 rounded-full border border-gray-300 bg-white p-0.5">
          {% elif match.league.name == "Serie A" %}
            <img src="{% static 'images/leagues/serie_a.png' %}" alt="Serie A" 
                 class="w-8 h-8 rounded-full border border-gray-300 bg-white p-0.5">
          {% elif match.league.name == "Bundesliga" %}
            <img src="{% static 'images/leagues/bundesliga.png' %}" alt="Bundesliga" 
                 class="w-8 h-8 rounded-full border border-gray-300 bg-white p-0.5">
          {% elif match.league.name == "Ligue 1" %}
            <img src="{% static 'images/leagues/ligue_1.png' %}" alt="Ligue 1" 
                 class="w-8 h-8 rounded-full border border-gray-300 bg-white p-0.5">
          {% else %}
            <img src="{% static 'images/leagues/default.png' %}" alt="{{ match.league.name }}" 
                 class="w-8 h-8 rounded-full border border-gray-300 bg-white p-0.5">
          {% endif %}

          <!-- League name links to filtered main page -->
          <a href="?league={{ match.league.id }}" 
             class="text-indigo-600 hover:text-indigo-800 font-semibold text-sm transition">
             {{ match.league.name }}
          </a>
        </div>

        <!-- Match Info -->
        <span class="text-sm text-gray-500">{{ match.match_date|date:"D, M d, Y H:i" }}</span>
        <span class="mt-1 inline-block px-3 py-1 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-lg uppercase tracking-wide">
          {{ match.status }}
        </span>
      </div>

      <!-- ‚öΩ Teams -->
      <div class="flex flex-col items-center justify-center gap-3 sm:w-1/2 text-center">
        <div class="flex flex-col sm:flex-row items-center justify-center gap-6">
          <div class="flex flex-col items-center">
            <img src="{{ match.home_team.logo_url }}" alt="{{ match.home_team.name }}"
                 class="w-20 h-20 mb-2 rounded-full border border-gray-200 p-1 bg-white">
            <p class="font-semibold text-base truncate w-28">{{ match.home_team.name }}</p>
          </div>

          <p class="font-bold text-xl text-gray-600">vs</p>

          <div class="flex flex-col items-center">
            <img src="{{ match.away_team.logo_url }}" alt="{{ match.away_team.name }}"
                 class="w-20 h-20 mb-2 rounded-full border border-gray-200 p-1 bg-white">
            <p class="font-semibold text-base truncate w-28">{{ match.away_team.name }}</p>
          </div>
        </div>

        <!-- üìä Win Probability -->
        <div class="mt-3">
          <p class="text-xs uppercase tracking-wide text-gray-500 font-semibold mb-1">Win Probability</p>
          {% if match.votes.count > 0 %}
            <p class="text-sm text-gray-800 font-medium">
              üè† {{ match.vote_summary.home_win }}% &nbsp;|&nbsp;
              ‚öñÔ∏è {{ match.vote_summary.draw }}% &nbsp;|&nbsp;
              üöÄ {{ match.vote_summary.away_win }}%
            </p>
          {% else %}
            <p class="text-xs text-gray-400 italic">No votes yet</p>
          {% endif %}
        </div>
      </div>

      <!-- üîò Buttons -->
      <div class="flex justify-center sm:justify-end gap-3 mt-4 sm:mt-0 sm:w-1/3">
        {% if user.is_authenticated %}
          <a href="{% url 'match_detail' match.id %}"
             class="bg-gray-700 hover:bg-gray-800 text-white px-4 py-2 rounded-lg text-sm font-medium transition">
             Vote Now
          </a>
        {% else %}
          <a href="{% url 'login' %}"
             class="bg-gray-400 hover:bg-gray-500 text-white px-4 py-2 rounded-lg text-sm font-medium transition">
             üîí Login to Vote
          </a>
        {% endif %}

        {% if user.is_staff %}
          <a href="{% url 'match_update' match.id %}"
             class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition">
            ‚úèÔ∏è Edit
          </a>
          <a href="{% url 'match_delete' match.id %}"
             class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition">
            üóëÔ∏è Delete
          </a>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>
{% else %}
  <p class="text-center text-gray-500 text-lg mt-20">No matches available ‚öΩ</p>
{% endif %}

